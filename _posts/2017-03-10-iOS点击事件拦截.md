---
layout: post
title: iOS点击事件拦截
--- 

如何去记录用户打开app后的所有点击，并且要记录点击在屏幕中的x、y坐标。
开始接到这问题时就是想通过runtime机制去做，拦截替换UIControl 的 sendAction:to:forEvent: 方法，但是还有UITapGestureRecognizer、cell的didSelect 等等 单个去做拦截替换还是麻烦了点。

---

想想事件都是从windon传过来的，那我们只要继承UIWindow,去实现调用方法就行了。
在发生触摸后，调用了windw的 hitTest:withEvent: 
<pre>
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event{
    UIView *touchView = [super hitTest:point withEvent:event];
    return touchView;
}
</pre>
返回的是最适合当前事件的控件，我这不用处理，直接调用父类方法返回就行。

这到一步就成功一半了

现在有点不明白的是
<pre>
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event{}
</pre>
当触碰屏幕后 方向调用了两次。

demo 链接 https://github.com/snsogbl/TapEventDemo

运行点击屏幕 看日志打印